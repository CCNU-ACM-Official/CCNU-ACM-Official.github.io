---
title: 博弈
titleTemplate: 数学
---

## 博弈

### 对称博弈

一个$n*m$的棋盘，两人轮流下棋，如果一个人下完后，棋盘上任意$k*k$的子矩阵内都存在至少一枚棋子则获胜，给定$n,m,k$，问先后手谁能赢？

如果$n\leq 2k-1\&\&m\leq 2k-1$，那么先手一步下完就结束了，特判掉。

否则，假设$n,m$都是奇数，那么棋盘一定有一个正中间的点，先手就下正中间。

之后，不管后手下到哪里$(x,y)$，先手都下在跟$(x,y)$与正中间对称的地方$(x',y')$，这样只要后手能下，先手就一定还能下，直到后手下不了为止，先手就能获胜。

如果$n,m$不都是奇数，那么棋盘的正中间就是在格线上，不管先手下哪，后手都去下在中心对称的地方，后手就能获胜。

### 优势类

例一：

一个$1*n$的棋盘（$n$是偶数），每个位置上有一个数字（数字和是奇数），两个人轮流取数字，只能取头或者尾部的数字，问谁能取到的数字总和最大？

答：先手必胜。

设所有奇数位置上的数字加起来是$s1$，偶数位置上的数字加起来是$s2$，那么如果$s1>s2$，先手就去拿第一个位置上的数字，这样头部是位置$2$，尾部是位置$n$，都是偶数位置，后手只能拿偶数位置上的数字，后手拿掉一个之后，头尾又变成一奇一偶，最后先手拿了所有奇数位置上的数字，后手只能拿所有偶数上的位置。

如果$s1<s2$，先拿最后一个。

例二：

$n$个序列，每个序列有$k_i$个数字，先手只能拿从某个序列前面拿，后手只能从某个序列后面拿，最后谁拿的数字最大？

某一个序列，如果它有偶数个数字，总共有$n$个数字，那么一定是前$n/2$，被先手拿走，后$n/2$个被后手拿走。

前$n/2$中较大的数字，后手拿不到，前$n/2$中较小的数字，后手不会去动，最后一定也归先手。

所以每个序列中的前$n/2$归先手，后$n/2$归后手。

如果$n$是奇数，那么中间的数字从大到小排序，先后手交替拿（先手有优势）。

### 巴什博弈

一堆石子有$n$个，每个人每次可以拿$1\sim m$个，先拿完的获胜，问先后手谁能赢？

如果$n\%(m+1)==0$，那么不管先手拿多少个，后手都可以让石子数量重新变成$m+1$的倍数，所以后手必胜。

如果$n$不是$m+1$的倍数，那么先手可以让石子数量变成$m+1$的倍数，从而获胜。

### 尼姆博弈

$n$堆石子，第$i$堆石子有$a_i$个，每个人每次可以从某一堆里面拿走任意多个，拿走最后一颗石子的人获胜，问先后手谁能获胜？

这个结论比较抽象。

设$x$是每一堆石子个数的**异或和**

如果$x$不是$0$，那么先手一定能让它变成$0$。

考虑$x$最高位的那个$1$，一定是某一堆贡献的（因为是异或，异或不会进位。）

那么将石子数量最多的那一堆拿走一部分，一定能将整个异或和变成$0$。

后手面对一个异或和为$0$的局面，一定会让异或和变得不为$0$。

所以这时候先手必胜。

如果一开始$x$为$0$，先后手就互换了，后手必胜。

#### 阶梯尼姆

将$n$堆石子放在$n$级阶梯上，每次只能将某一堆石子的任意个往下挪一级，都挪到第$0$级算赢，先后手谁赢？

对于偶数级上的石子，先手挪到奇数级去，后手又能挪到偶数级去，等于先后手都没动。

所以答案是判断所有在奇数级上的石子的异或和。

### 练习题

[P3150 pb的游戏（1）  ](https://www.luogu.com.cn/problem/P3150)

[P4018 Roy&October之取石子](https://www.luogu.com.cn/problem/P4018)

[P4860 Roy&October之取石子II  ](https://www.luogu.com.cn/problem/P4860)

[P2197 【模板】nim 游戏  ](https://www.luogu.com.cn/problem/P2197)

















